{"version":3,"sources":["services/moviedb-service/no_image_poster.png","services/moviedb-service/moviedb-service.js","components/movie-item/__header/movie-item___header.js","components/movie-item/__header/index.js","components/movie-item/movie-item.js","services/cut-overflow-content/cut-overflow-content.js","components/movie-list/movie-list.js","components/movie-list/index.js","components/header/header.js","components/header/index.js","components/app/app.js","components/app/index.js","index.js"],"names":["MovieDBService","_apiKey","_apiBase","requestFromDB","request","a","fetch","response","json","data","searchMovies","page","keyword","getActualGenresList","genres","results","map","el","createDataMovie","currentPage","totalResults","total_results","genresList","reduce","acc","id","name","date","genre_ids","format","Date","release_date","err","poster","poster_path","noFoundPoster","title","overview","vote","vote_average","popularity","Math","trunc","MovieItemHeader","genresBlocks","className","src","alt","defaultProps","MovieItem","selector","overviewBlocks","document","getElementById","scrollHeight","clientHeight","lastSpace","textContent","lastIndexOf","slice","cutOverflowContent","this","props","other","defaultValue","allowHalf","count","style","fontSize","verticalAlign","lineHeight","React","Component","MovieList","movies","xs","span","lg","changePages","currentSearch","moviesList","createMovieList","paginationShow","current","total","onChange","pageSize","showSizeChanger","pagination","length","gutter","Header","state","inputValue","newRequest","debounce","value","newSearch","changeInputValue","evt","setState","target","placeholder","App","movieDBService","loading","loadingError","getMoviesData","responseMovies","messages","errorMessage","noResultsMessage","alertShow","message","description","showIcon","type","noResultsShow","contentShow","noResults","error","spinner","Spinner","content","size","ReactDOM","render"],"mappings":"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","file":"static/js/main.163756ec.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/no_image_poster.68ae3506.png\";","import { format } from 'date-fns';\nimport noFoundPoster from './no_image_poster.png';\n\nexport default class MovieDBService {\n  _apiKey = 'api_key=b7473b579abba0475a9336164324a2c1';\n\n  _apiBase = 'https://api.themoviedb.org/3';\n\n  requestFromDB = async (request) => {\n    const response = await fetch(`${this._apiBase}${request}`);\n    const data = await response.json();\n    return data;\n  };\n\n  searchMovies = async (page, keyword) => {\n    const response = await this.requestFromDB(`/search/movie?${this._apiKey}&query=${keyword}&page=${page}`);\n    const genres = await this.getActualGenresList();\n    const data = response.results.map((el) => this.createDataMovie(el, genres));\n    return {\n      data,\n      currentPage: response.page,\n      totalResults: response.total_results,\n    };\n  };\n\n  getActualGenresList = async () => {\n    const genresList = await this.requestFromDB(`/genre/movie/list?${this._apiKey}`);\n    return genresList.genres.reduce((acc, el) => {\n      acc[el.id] = el.name;\n      return acc;\n    }, {});\n  };\n\n  createDataMovie = (data, genresList) => {\n    const genres = data.genre_ids.map((id) => ({ id, name: genresList[id] }));\n    let date;\n    try {\n      date = format(new Date(data.release_date), 'MMM d, y');\n    } catch (err) {\n      date = 'No date info';\n    }\n\n    const poster = data.poster_path ? `https://image.tmdb.org/t/p/w500${data.poster_path}` : noFoundPoster;\n\n    return {\n      id: data.id,\n      title: data.title,\n      overview: data.overview,\n      date,\n      poster,\n      genres,\n      vote: data.vote_average,\n      popularity: Math.trunc(data.popularity) / 10,\n    };\n  };\n}\n","import React from 'react';\nimport './movie-item__header.css';\nimport PropTypes from 'prop-types';\n\nexport default function MovieItemHeader({ poster, vote, title, date, genres }) {\n  const genresBlocks = genres.map((el) => (\n    <span key={el.id} className=\"movie-item__genres-item\">\n      {el.name}\n    </span>\n  ));\n\n  return (\n    <header className=\"movie-item__header\">\n      <img className=\"movie-item__poster\" src={poster} alt=\"Movie poster\" />\n      <div className=\"movie-item__header-content\">\n        <div className=\"movie-item__vote-container\">\n          <span className=\"movie-item__vote\">{vote}</span>\n        </div>\n        <h3 className=\"movie-item__title\">{title}</h3>\n        <div className=\"movie-item__date\">{date}</div>\n        <div className=\"movie-item__genres-container\">{genresBlocks}</div>\n      </div>\n    </header>\n  );\n}\n\nMovieItemHeader.defaultProps = {\n  genres: ['No info'],\n  vote: 0,\n};\n\nMovieItemHeader.propTypes = {\n  title: PropTypes.string.isRequired,\n  date: PropTypes.string.isRequired,\n  poster: PropTypes.string.isRequired,\n  genres: PropTypes.arrayOf(PropTypes.object),\n  vote: PropTypes.number,\n};\n","import MovieItemHeader from './movie-item___header';\n\nexport default MovieItemHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Rate } from 'antd';\n\nimport './movie-item.css';\nimport MovieItemHeader from './__header';\nimport cutOverflowContent from '../../services/cut-overflow-content/cut-overflow-content';\n\nexport default class MovieItem extends React.Component {\n  static defaultProps = {\n    popularity: 0,\n    overview: 'Overview not found',\n  };\n\n  static propTypes = {\n    overview: PropTypes.string,\n    popularity: PropTypes.number,\n    id: PropTypes.number.isRequired,\n  };\n\n  componentDidMount() {\n    const { id } = this.props;\n    cutOverflowContent(id);\n  }\n\n  render() {\n    const { overview, popularity, id, ...other } = this.props;\n\n    return (\n      <div className=\"movie-item\">\n        <MovieItemHeader {...other} />\n        <p id={id} className=\"movie-item__overview\">\n          {overview}\n        </p>\n        <footer className=\"movie-item__footer\">\n          <Rate\n            defaultValue={popularity}\n            allowHalf\n            count={10}\n            style={{ fontSize: '1.3em', verticalAlign: 'middle', lineHeight: '46px' }}\n          />\n        </footer>\n      </div>\n    );\n  }\n}\n","export default function cutOverflowContent(selector) {\n  const overviewBlocks = document.getElementById(selector);\n  while (overviewBlocks.scrollHeight > overviewBlocks.clientHeight) {\n    const lastSpace = overviewBlocks.textContent.lastIndexOf(' ');\n    overviewBlocks.textContent = `${overviewBlocks.textContent.slice(0, lastSpace)}...`;\n  }\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Row, Col, Pagination } from 'antd';\nimport './movie-list.css';\n\nimport MovieItem from '../movie-item/movie-item';\n\nexport default class MovieList extends React.Component {\n  static propTypes = {\n    movies: PropTypes.arrayOf(PropTypes.object).isRequired,\n    changePages: PropTypes.func.isRequired,\n    currentPage: PropTypes.number.isRequired,\n    currentSearch: PropTypes.string.isRequired,\n    totalResults: PropTypes.number.isRequired,\n  };\n\n  createMovieList(movies) {\n    return movies.map((el) => {\n      const { id } = el;\n      return (\n        <Col key={id} xs={{ span: 24 }} lg={{ span: 12 }}>\n          <MovieItem {...el} />\n        </Col>\n      );\n    });\n  }\n\n  render() {\n    const { movies, changePages, currentPage, currentSearch, totalResults } = this.props;\n    const moviesList = this.createMovieList(movies);\n    const paginationShow = (\n      <Pagination\n        current={currentPage}\n        total={totalResults}\n        onChange={(page) => changePages(page, currentSearch)}\n        pageSize={20}\n        showSizeChanger={false}\n      />\n    );\n    const pagination = moviesList.length ? paginationShow : null;\n\n    return (\n      <>\n        <Row gutter={[36, 36]}>{moviesList}</Row>\n        <div className=\"movie-list__pagination-container\">{pagination}</div>\n      </>\n    );\n  }\n}\n","import MovieList from './movie-list';\n\nexport default MovieList;\n","import React from 'react';\nimport { Input } from 'antd';\nimport PropTypes from 'prop-types';\nimport debounce from 'lodash.debounce';\n\nimport './header.css';\n\nexport default class Header extends React.Component {\n  static propTypes = {\n    newSearch: PropTypes.func.isRequired,\n  };\n\n  state = {\n    inputValue: null,\n  };\n\n  // eslint-disable-next-line react/destructuring-assignment\n  newRequest = debounce((value) => this.props.newSearch(1, value), 400);\n\n  changeInputValue = (evt) => {\n    this.setState({ inputValue: evt.target.value });\n    this.newRequest(evt.target.value);\n  };\n\n  render() {\n    const { inputValue } = this.state;\n    return (\n      <header className=\"header\">\n        <Input onChange={this.changeInputValue} placeholder=\"Type to search...\" value={inputValue} />\n      </header>\n    );\n  }\n}\n","import Header from './header';\n\nexport default Header;\n","import React from 'react';\nimport { Spin, Alert } from 'antd';\nimport MovieDBService from '../../services/moviedb-service/moviedb-service';\n\nimport './app.css';\nimport MovieList from '../movie-list';\nimport Header from '../header';\n\nexport default class App extends React.Component {\n  static messages = {\n    errorMessage: 'Sorry, something went wrong. Try to reload the page and repeat.',\n    noResultsMessage: 'Sorry, no results were found. Try to change your request.',\n  };\n\n  movieDBService = new MovieDBService();\n\n  state = {\n    movies: [],\n    currentSearch: '',\n    currentPage: 1,\n    totalResults: 0,\n    loading: true,\n    loadingError: false,\n  };\n\n  componentDidMount() {\n    const { currentPage, currentSearch } = this.state;\n    this.getMoviesData(currentPage, currentSearch);\n  }\n\n  getMoviesData = async (page, keyword) => {\n    if (keyword === '') {\n      this.setState({ movies: [], currentSearch: '', totalResults: 0, loading: false });\n      return;\n    }\n    try {\n      this.setState({ loading: true });\n      const responseMovies = await this.movieDBService.searchMovies(page, keyword);\n      const { data, currentPage, totalResults } = responseMovies;\n      this.setState({ movies: data, loading: false, currentSearch: keyword, currentPage, totalResults });\n    } catch (er) {\n      this.setState({ loadingError: true, loading: false });\n    }\n  };\n\n  render() {\n    const { loading, loadingError, currentSearch, totalResults, ...data } = this.state;\n    const { errorMessage, noResultsMessage } = App.messages;\n    const alertShow = <Alert message=\"Bad news\" description={errorMessage} showIcon type=\"error\" />;\n    const noResultsShow = <Alert message=\"Oooops\" description={noResultsMessage} showIcon type=\"info\" />;\n    const contentShow = (\n      <MovieList changePages={this.getMoviesData} currentSearch={currentSearch} totalResults={totalResults} {...data} />\n    );\n\n    const noResults = currentSearch.length && !totalResults && !loading ? noResultsShow : null;\n    const error = loadingError ? alertShow : null;\n    const spinner = loading ? <Spinner /> : null;\n    const content = !(loading || loadingError) ? contentShow : null;\n\n    return (\n      <div className=\"container\">\n        <Header newSearch={this.getMoviesData} />\n        {noResults}\n        {error}\n        {spinner}\n        {content}\n      </div>\n    );\n  }\n}\n\nfunction Spinner() {\n  return (\n    <div className=\"example\">\n      <Spin size=\"large\" />\n    </div>\n  );\n}\n","import App from './app';\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'antd/dist/antd.css';\nimport './index.css';\n\nimport App from './components/app';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}