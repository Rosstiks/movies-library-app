(this.webpackJsonptodo=this.webpackJsonptodo||[]).push([[0],{125:function(e,t,a){},127:function(e,t,a){},128:function(e,t,a){},129:function(e,t,a){},130:function(e,t,a){},200:function(e,t,a){},206:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(33),c=a.n(s),i=(a(124),a(125),a(1)),o=a(11),u=a(27),l=a.n(u),p=a(41),v=a(10),h=a(12),d=a(14),j=a(13),m=a(214),g=a(210),b=a(211),f=a.p+"static/media/no_image_poster.68ae3506.png",O=function e(){var t=this;Object(v.a)(this,e),this._apiKey="api_key=b7473b579abba0475a9336164324a2c1",this._apiBase="https://api.themoviedb.org/3",this.requestFromDB=function(){var e=Object(p.a)(l.a.mark((function e(a){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t._apiBase).concat(a));case 2:return r=e.sent,e.next=5,r.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.searchMovies=function(){var e=Object(p.a)(l.a.mark((function e(a,r){var n,s,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.requestFromDB("/search/movie?".concat(t._apiKey,"&query=").concat(r,"&page=").concat(a));case 2:return n=e.sent,e.next=5,t.getActualGenresList();case 5:return s=e.sent,c=n.results.map((function(e){return t.createDataMovie(e,s)})),e.abrupt("return",{data:c,currentPage:n.page,totalResults:n.total_results});case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.getActualGenresList=Object(p.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.requestFromDB("/genre/movie/list?".concat(t._apiKey));case 2:return a=e.sent,e.abrupt("return",a.genres.reduce((function(e,t){return e[t.id]=t.name,e}),{}));case 4:case"end":return e.stop()}}),e)}))),this.createDataMovie=function(e,t){var a,r=e.genre_ids.map((function(e){return{id:e,name:t[e]}}));try{a=Object(b.a)(new Date(e.release_date),"MMM d, y")}catch(s){a="No date info"}var n=e.poster_path?"https://image.tmdb.org/t/p/w500".concat(e.poster_path):f;return{id:e.id,title:e.title,overview:e.overview,date:a,poster:n,genres:r,vote:e.vote_average,popularity:Math.trunc(e.popularity)/10}}},x=(a(127),a(217)),y=a(212),_=a(216),w=(a(128),a(215)),S=(a(129),a(130),a(8));function M(e){var t=e.poster,a=e.vote,r=e.title,n=e.date,s=e.genres.map((function(e){return Object(S.jsx)("span",{className:"movie-item__genres-item",children:e.name},e.id)}));return Object(S.jsxs)("header",{className:"movie-item__header",children:[Object(S.jsx)("img",{className:"movie-item__poster",src:t,alt:"Movie poster"}),Object(S.jsxs)("div",{className:"movie-item__header-content",children:[Object(S.jsx)("div",{className:"movie-item__vote-container",children:Object(S.jsx)("span",{className:"movie-item__vote",children:a})}),Object(S.jsx)("h3",{className:"movie-item__title",children:r}),Object(S.jsx)("div",{className:"movie-item__date",children:n}),Object(S.jsx)("div",{className:"movie-item__genres-container",children:s})]})]})}M.defaultProps={genres:["No info"],vote:0};var N=M;var k=["overview","popularity","id"],D=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(){return Object(v.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"componentDidMount",value:function(){!function(e){for(var t=document.getElementById(e);t.scrollHeight>t.clientHeight;){var a=t.textContent.lastIndexOf(" ");t.textContent="".concat(t.textContent.slice(0,a),"...")}}(this.props.id)}},{key:"render",value:function(){var e=this.props,t=e.overview,a=e.popularity,r=e.id,n=Object(o.a)(e,k);return Object(S.jsxs)("div",{className:"movie-item",children:[Object(S.jsx)(N,Object(i.a)({},n)),Object(S.jsx)("p",{id:r,className:"movie-item__overview",children:t}),Object(S.jsx)("footer",{className:"movie-item__footer",children:Object(S.jsx)(w.a,{defaultValue:a,allowHalf:!0,count:10,style:{fontSize:"1.3em",verticalAlign:"middle",lineHeight:"46px"}})})]})}}]),a}(n.a.Component);D.defaultProps={popularity:0,overview:"Overview not found"};var R=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(){return Object(v.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"createMovieList",value:function(e){return e.map((function(e){var t=e.id;return Object(S.jsx)(x.a,{xs:{span:24},lg:{span:12},children:Object(S.jsx)(D,Object(i.a)({},e))},t)}))}},{key:"render",value:function(){var e=this.props,t=e.movies,a=e.changePages,r=e.currentPage,n=e.currentSearch,s=e.totalResults,c=this.createMovieList(t),i=Object(S.jsx)(y.a,{current:r,total:s,onChange:function(e){return a(e,n)},pageSize:20,showSizeChanger:!1}),o=c.length?i:null;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(_.a,{gutter:[36,36],children:c}),Object(S.jsx)("div",{className:"movie-list__pagination-container",children:o})]})}}]),a}(n.a.Component),B=R,C=a(213),P=a(111),q=a.n(P),I=(a(200),function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(v.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={inputValue:null},e.newRequest=q()((function(t){return e.props.newSearch(1,t)}),400),e.changeInputValue=function(t){e.setState({inputValue:t.target.value}),e.newRequest(t.target.value)},e}return Object(h.a)(a,[{key:"render",value:function(){var e=this.state.inputValue;return Object(S.jsx)("header",{className:"header",children:Object(S.jsx)(C.a,{onChange:this.changeInputValue,placeholder:"Type to search...",value:e})})}}]),a}(n.a.Component)),E=I,V=["loading","loadingError","currentSearch","totalResults"],A=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(v.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).movieDBService=new O,e.state={movies:[],currentSearch:"",currentPage:1,totalResults:0,loading:!0,loadingError:!1},e.getMoviesData=function(){var t=Object(p.a)(l.a.mark((function t(a,r){var n,s,c,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==r){t.next=3;break}return e.setState({movies:[],currentSearch:"",totalResults:0,loading:!1}),t.abrupt("return");case 3:return t.prev=3,e.setState({loading:!0}),t.next=7,e.movieDBService.searchMovies(a,r);case 7:n=t.sent,s=n.data,c=n.currentPage,i=n.totalResults,e.setState({movies:s,loading:!1,currentSearch:r,currentPage:c,totalResults:i}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),e.setState({loadingError:!0,loading:!1});case 15:case"end":return t.stop()}}),t,null,[[3,12]])})));return function(e,a){return t.apply(this,arguments)}}(),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this.state,t=e.currentPage,a=e.currentSearch;this.getMoviesData(t,a)}},{key:"render",value:function(){var e=this.state,t=e.loading,r=e.loadingError,n=e.currentSearch,s=e.totalResults,c=Object(o.a)(e,V),u=a.messages,l=u.errorMessage,p=u.noResultsMessage,v=Object(S.jsx)(m.a,{message:"Bad news",description:l,showIcon:!0,type:"error"}),h=Object(S.jsx)(m.a,{message:"Oooops",description:p,showIcon:!0,type:"info"}),d=Object(S.jsx)(B,Object(i.a)({changePages:this.getMoviesData,currentSearch:n,totalResults:s},c)),j=!n.length||s||t?null:h,g=r?v:null,b=t?Object(S.jsx)(z,{}):null,f=t||r?null:d;return Object(S.jsxs)("div",{className:"container",children:[Object(S.jsx)(E,{newSearch:this.getMoviesData}),j,g,b,f]})}}]),a}(n.a.Component);function z(){return Object(S.jsx)("div",{className:"example",children:Object(S.jsx)(g.a,{size:"large"})})}A.messages={errorMessage:"Sorry, something went wrong. Try to reload the page and repeat.",noResultsMessage:"Sorry, no results were found. Try to change your request."};var F=A;c.a.render(Object(S.jsx)(F,{}),document.getElementById("root"))}},[[206,1,2]]]);
//# sourceMappingURL=main.163756ec.chunk.js.map