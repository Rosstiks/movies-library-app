(this.webpackJsonptodo=this.webpackJsonptodo||[]).push([[0],{130:function(e,t,a){},132:function(e,t,a){},133:function(e,t,a){},134:function(e,t,a){},135:function(e,t,a){},205:function(e,t,a){},211:function(e,t,a){},212:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(36),s=a.n(c),i=(a(129),a(130),a(1)),o=a(18),u=a(8),l=a(24),h=a.n(l),d=a(40),v=a(13),p=a(14),f=a(16),g=a(15),j=a(219),m=(a(132),a(217)),b=a.p+"static/media/no_image_poster.68ae3506.png",O=function e(){var t=this;Object(v.a)(this,e),this._apiKey="api_key=b7473b579abba0475a9336164324a2c1",this._apiBase="https://api.themoviedb.org/3",this._imageBase="https://image.tmdb.org/t/p/w500",this.requestFromDB=function(){var e=Object(d.a)(h.a.mark((function e(a){var r,n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t._apiBase).concat(a),e.next=3,fetch(r);case 3:return n=e.sent,e.next=6,n.json();case 6:return c=e.sent,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createGuestSession=Object(d.a)(h.a.mark((function e(){var a,r,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(t._apiBase,"/authentication/guest_session/new?").concat(t._apiKey),e.next=3,fetch(a);case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",n.guest_session_id);case 8:case"end":return e.stop()}}),e)}))),this.rateMovie=function(){var e=Object(d.a)(h.a.mark((function e(a,r,n){var c,s,i,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="".concat(t._apiBase,"/movie/").concat(a,"/rating?").concat(t._apiKey,"&guest_session_id=").concat(n),s={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({value:r})},e.next=4,fetch(c,s);case 4:return i=e.sent,e.next=7,i.json();case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),this.searchMovies=function(){var e=Object(d.a)(h.a.mark((function e(a,r,n,c){var s,i,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n?"/guest_session/".concat(c,"/rated/movies?").concat(t._apiKey,"&page=").concat(a):"/search/movie?".concat(t._apiKey,"&query=").concat(r,"&page=").concat(a),e.next=3,t.requestFromDB(s);case 3:return i=e.sent,o=i.results.map((function(e){return t.createDataMovie(e)})),e.abrupt("return",{data:o,currentPage:i.page,totalResults:i.total_results});case 6:case"end":return e.stop()}}),e)})));return function(t,a,r,n){return e.apply(this,arguments)}}(),this.getGenresList=Object(d.a)(h.a.mark((function e(){var a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/genre/movie/list?".concat(t._apiKey),e.next=3,t.requestFromDB(a);case 3:return r=e.sent,e.abrupt("return",r.genres.reduce((function(e,t){return e[t.id]=t.name,e}),{}));case 5:case"end":return e.stop()}}),e)}))),this.createDataMovie=function(e){var a;try{a=Object(m.a)(new Date(e.release_date),"MMM d, y")}catch(n){a="No date info"}var r=e.poster_path?"".concat(t._imageBase).concat(e.poster_path):b;return{id:e.id,title:e.title,overview:e.overview,date:a,poster:r,genresIds:e.genre_ids,globalRate:e.vote_average,userRate:e.rating||0}}};function R(e){document.querySelectorAll(e).forEach((function(e){if(e.clientHeight)for(;e.scrollHeight>e.clientHeight;){var t=e.textContent.lastIndexOf(" ");e.textContent="".concat(e.textContent.slice(0,t),"...")}}))}var x=a(224),_=a(218),S=a(223),w=(a(133),n.a.createContext()),y=w.Provider,P=w.Consumer,D=(a(134),a(135),a(2)),k=a.n(D),N=a(9);function B(e){var t=e.poster,a=e.globalRate,r=e.title,n=e.date,c=e.genresIds,s=e.genresList,i=c.map((function(e){return Object(N.jsx)("span",{className:"movie-item__genres-item",children:s[e]},e)})),o=k()({"movie-item__vote-container--low":a<3,"movie-item__vote-container--pre-intermediate":a>=3&&a<5,"movie-item__vote-container--intermediate":a>=5&&a<7});return Object(N.jsxs)("header",{className:"movie-item__header",children:[Object(N.jsx)("img",{className:"movie-item__poster",src:t,alt:"Movie poster"}),Object(N.jsxs)("div",{className:"movie-item__header-content",children:[Object(N.jsx)("div",{className:"movie-item__vote-container ".concat(o),children:Object(N.jsx)("span",{className:"movie-item__vote",children:a})}),Object(N.jsx)("h3",{className:"movie-item__title",children:r}),Object(N.jsx)("div",{className:"movie-item__date",children:n}),Object(N.jsx)("div",{className:"movie-item__genres-container",children:i})]})]})}B.defaultProps={globalRate:0,genresList:{}};var I=B,C=a(222);function M(e){var t=e.userRate,a=e.changeRate;return Object(N.jsx)(C.a,{onChange:function(e){return a(e)},defaultValue:t,allowHalf:!0,count:10,style:{fontSize:"1.2em",verticalAlign:"middle",lineHeight:"46px"}})}M.defaultProps={userRate:0};var E=M,L=["overview","userRate","id"],q=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(v.a)(this,a);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).movieDBService=new O,e.changeRate=function(t){var a=e.movieDBService.rateMovie,r=e.props,n=r.id,c=r.sessionID,s=r.refreshRated;a(n,t,c).then((function(){setTimeout((function(){return s()}),1e3)}))},e}return Object(p.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.overview,r=t.userRate,n=t.id,c=Object(u.a)(t,L);return Object(N.jsxs)("div",{className:"movie-item",children:[Object(N.jsx)(P,{children:function(e){return Object(N.jsx)(I,Object(i.a)(Object(i.a)({},c),{},{genresList:e}))}}),Object(N.jsx)("p",{id:n,className:"movie-item__overview",children:a}),Object(N.jsx)("footer",{className:"movie-item__footer",children:Object(N.jsx)(E,{userRate:r,changeRate:function(t){return e.changeRate(t)}})})]})}}]),a}(n.a.Component);q.defaultProps={userRate:0,overview:"Overview not found",sessionID:null};var K=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(){return Object(v.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"componentDidMount",value:function(){R(".movie-item__overview")}},{key:"createMovieList",value:function(e){var t=this.props,a=t.sessionID,r=t.refreshRated;return e.map((function(e){var t=e.id;return Object(N.jsx)(x.a,{xs:{span:24},lg:{span:12},children:Object(N.jsx)(q,Object(i.a)({sessionID:a,refreshRated:r},e))},t)}))}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.changePage,r=e.currentPage,n=e.currentSearch,c=e.totalResults,s=this.createMovieList(t),i=Object(N.jsx)(_.a,{current:r,total:c,onChange:function(e){return a(e,n)},pageSize:20,showSizeChanger:!1}),o=s.length?i:null;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(S.a,{gutter:[36,36],children:s}),Object(N.jsx)("div",{className:"movie-list__pagination-container",children:o})]})}}]),a}(n.a.Component);K.defaultProps={currentPage:0,currentSearch:"",sessionID:null};var T=K,A=a(221);var V=function(e){var t=e.type,a={noResult:"No matches",error:"Bad news",noRated:"It's empty here for now"}[t],r={noResult:"Sorry, no results were found. Try to change your request.",error:"Sorry, something went wrong. Try to reload the page and repeat.",noRated:"Rate movies to add to the list"}[t];return Object(N.jsx)(A.a,{message:a,description:r,showIcon:!0,type:"info"})},H=a(216);a(205);var z=function(){return Object(N.jsx)(H.a,{className:"load-spinner",size:"large"})},F=["loading","loadingError","currentSearch","totalResults","changePage","refreshRated","search"];function G(e){var t=e.loading,a=e.loadingError,r=e.currentSearch,n=e.totalResults,c=e.changePage,s=e.refreshRated,o=e.search,l=Object(u.a)(e,F);return a?Object(N.jsx)(V,{type:"error"}):t?Object(N.jsx)(z,{}):!n&&!t&&r&&o?Object(N.jsx)(V,{type:"noResult"}):t||a?void 0:Object(N.jsx)(T,Object(i.a)({changePage:c,currentSearch:r,totalResults:n,refreshRated:s},l))}G.defaultProps={currentSearch:"",search:!1};var J=G,Q=a(220),U=a(116),W=a.n(U),X=(a(211),function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(v.a)(this,a);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={inputValue:null},e.newRequest=W()((function(t){return e.props.newSearch(1,t)}),400),e.changeInputValue=function(t){e.setState({inputValue:t.target.value}),e.newRequest(t.target.value)},e}return Object(p.a)(a,[{key:"render",value:function(){var e=this.state.inputValue;return Object(N.jsx)("header",{className:"header",children:Object(N.jsx)(Q.a,{onChange:this.changeInputValue,placeholder:"Type to search...",value:e})})}}]),a}(n.a.Component)),Y=X,Z=["data","ratedData","currentPageSearch","currentPageRated","totalResultsSearch","totalResultsRated"],$=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(v.a)(this,a);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).movieDBService=new O,e.state={data:[],ratedData:[],currentSearch:"",currentPageSearch:1,currentPageRated:1,totalResultsSearch:0,totalResultsRated:0,loading:!1,loadingError:!1,sessionID:null},e.getData=function(){var t=Object(d.a)(h.a.mark((function t(a,r,n,c){var s,i,o,u,l;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==r||n){t.next=3;break}return e.setState({data:[],currentSearch:"",totalResultsSearch:0,loading:!1}),t.abrupt("return");case 3:return t.prev=3,s=e.movieDBService.searchMovies,e.setState({loading:!0,loadingError:!1}),t.next=8,s(a,r,n,c);case 8:i=t.sent,o=i.data,u=i.currentPage,l=i.totalResults,e.setState((function(e){return{data:n?e.data:o,ratedData:n?o:e.ratedData,loading:!1,currentSearch:n?e.currentSearch:r,currentPageSearch:n?e.currentPageSearch:u,currentPageRated:n?u:e.currentPageRated,totalResultsSearch:n?e.totalResultsSearch:l}})),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),e.setState({loadingError:!0,loading:!1});case 16:case"end":return t.stop()}}),t,null,[[3,13]])})));return function(e,a,r,n){return t.apply(this,arguments)}}(),e.refreshRated=Object(d.a)(h.a.mark((function t(){var a,r,n,c,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.movieDBService.searchMovies,r=e.state,n=r.sessionID,c=r.currentPageRated,t.next=4,a(c,null,!0,n);case 4:s=t.sent,e.setState({ratedData:s.data,totalResultsRated:s.totalResults});case 6:case"end":return t.stop()}}),t)}))),e.changePageSearch=function(t){var a=e.state.currentSearch;e.getData(t,a)},e.changePageRated=function(t){var a=e.state.sessionID;e.getData(t,null,!0,a)},e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.movieDBService,a=t.createGuestSession,r=t.getGenresList;a().then((function(t){return e.setState({sessionID:t})})),r().then((function(t){e.genresList=t}))}},{key:"render",value:function(){var e=j.a.TabPane,t=this.state,a=t.data,r=t.ratedData,n=t.currentPageSearch,c=t.currentPageRated,s=t.totalResultsSearch,l=t.totalResultsRated,h=Object(u.a)(t,Z),d=Object(o.a)(a);return d.forEach((function(e){r.forEach((function(t){e.id===t.id&&(e.userRate=t.userRate)}))})),Object(N.jsx)(y,{value:this.genresList,children:Object(N.jsx)("div",{className:"container",children:Object(N.jsxs)(j.a,{defaultActiveKey:"search",onChange:function(){return setTimeout((function(){return R(".movie-item__overview")}),100)},children:[Object(N.jsxs)(e,{tab:"Search",forceRender:!0,children:[Object(N.jsx)(Y,{newSearch:this.getData}),Object(N.jsx)(J,Object(i.a)({search:!0,refreshRated:this.refreshRated,data:d,totalResults:s,currentPage:n,changePage:this.changePageSearch},h))]},"search"),Object(N.jsx)(e,{tab:"Rated",children:Object(N.jsx)(J,Object(i.a)({refreshRated:this.refreshRated,data:r,totalResults:l,currentPage:c,changePage:this.changePageRated},h))},"rated")]})})})}}]),a}(n.a.Component),ee=$;s.a.render(Object(N.jsx)(ee,{}),document.getElementById("root"))}},[[212,1,2]]]);
//# sourceMappingURL=main.c13e3d3c.chunk.js.map